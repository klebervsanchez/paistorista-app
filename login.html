<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login - Paistorista</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
</head>
<body class="bg-light d-flex justify-content-center align-items-center vh-100">
  <div class="card shadow p-4 text-center">
    <h2 class="mb-3">ğŸš— Paistorista</h2>
    <p>Organize caronas escolares com seguranÃ§a</p>
    <p class="mb-3">Escolha como deseja entrar:</p>
    <div class="d-flex justify-content-center gap-3">
      <button class="btn btn-primary" onclick="login('motorista')">
        <i class="material-icons align-middle me-1">drive_eta</i> Entrar como Motorista
      </button>
      <button class="btn btn-secondary" onclick="login('passageiro')">
        <i class="material-icons align-middle me-1">group</i> Entrar como Passageiro
      </button>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js" defer></script>
  <script src="firebase-config.js" defer></script>

  <script defer>
    function login(tipo) {
      const provider = new firebase.auth.GoogleAuthProvider();
      firebase.auth().signInWithPopup(provider)
        .then(result => {
          const user = result.user;
          const db = firebase.firestore();
          db.collection("usuarios").doc(user.uid).set({
            nome: user.displayName,
            email: user.email,
            tipo: tipo
          }, { merge: true })
          .then(() => {
            window.location.href = "index.html";  // Redireciona para index.html
          })
          .catch(error => {
            alert("âš ï¸ Erro ao salvar dados: " + error.message);
          });
        })
        .catch(error => {
          alert("âš ï¸ Erro ao autenticar: " + error.message);
        });
    }
  </script>
</body>
</html>
